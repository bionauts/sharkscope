:root{
  --bg:#0A192F; --panel:#0F2547; --fg:#E6EDF3; --muted:#9AA4AE; --border:#1C325A;
  --accent:#3BA3FF; --good:#2ECC71; --mid:#F1C40F; --bad:#E74C3C; --focus:#86B7FE;
  --violet:#9b6cff;
}
*{box-sizing:border-box}
html,body{height:100%;margin:0;background:var(--bg);color:var(--fg);font-family:Inter,system-ui,Segoe UI,Arial,sans-serif}
a{color:#8bc1ff}
.app{display:grid;grid-template-rows:auto 1fr auto;min-height:100%}
header{display:flex;align-items:center;gap:12px;padding:10px 14px;border-bottom:1px solid var(--border);position:sticky;top:0;background:rgba(10,25,47,.9);backdrop-filter:saturate(120%) blur(4px);z-index:10}
.brand-logos{display:flex;align-items:center;gap:12px}
.logo-sharkscope{height:32px;width:auto}
.logo-bionauts{height:32px;width:auto}
.logo-divider{color:rgba(255,255,255,.3);font-size:32px;font-weight:100;line-height:1}
.brand{font-weight:700;letter-spacing:.3px}
.pill{border:1px solid var(--border);padding:2px 8px;border-radius:999px;font-size:12px;color:var(--muted)}
.grow{flex:1}
.toolbar{display:flex;gap:8px;align-items:center}
.btn{background:transparent;border:1px solid var(--border);color:var(--fg);padding:6px 10px;border-radius:8px;cursor:pointer}
.btn:hover{border-color:#2b4b86}
.btn-primary{background:#1b3a6a;border-color:#1b3a6a}
.btn-primary:hover{background:#234a86}
.btn-toggle[aria-pressed="true"]{background:#18335f;border-color:#2b4b86}
.seg{display:inline-flex;border:1px solid var(--border);border-radius:10px;overflow:hidden}
.seg button{border:0;padding:6px 10px;background:transparent;color:var(--fg);cursor:pointer}
.seg button[aria-pressed="true"]{background:#16315a}
.kbd{border:1px solid var(--border);border-bottom-width:2px;border-radius:6px;padding:0 6px;font:12px/18px ui-monospace,Menlo,Consolas,monospace;color:var(--muted)}
main{display:grid;grid-template-columns:2fr 1fr;gap:12px;padding:12px}
@media (max-width: 980px){ main{grid-template-columns:1fr} }
.map-wrap{position:relative;min-height:60vh;border:1px solid var(--border);border-radius:12px;overflow:hidden}
#map{position:absolute;inset:0}
.overlay{position:absolute;z-index:5}
.top-center{top:10px;left:50%;transform:translateX(-50%)}
.bottom-left{left:10px;bottom:10px}
.bottom-center{left:50%;bottom:10px;transform:translateX(-50%)}
.legend{background:var(--panel);border:1px solid var(--border);padding:10px;border-radius:10px}
.sidebar{background:var(--panel);border:1px solid var(--border);border-radius:12px;padding:12px;display:flex;flex-direction:column;gap:12px;min-height:60vh}
.cards{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.card{border:1px solid var(--border);border-radius:10px;padding:10px}
.title{font-weight:600;margin-bottom:6px}
.big{font-size:28px;font-weight:700}
.muted{color:var(--muted)}
.bars{display:grid;gap:8px}
.bar{display:grid;grid-template-columns:110px 1fr 48px;gap:8px;align-items:center}
.bar .track{height:10px;border-radius:6px;background:#0b1a33;border:1px solid var(--border);overflow:hidden}
.bar .fill{height:100%;background:linear-gradient(90deg,var(--good),var(--mid),var(--bad))}
.row{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
footer{display:flex;align-items:center;justify-content:space-between;gap:10px;padding:10px 14px;border-top:1px solid var(--border)}
input[type="date"]{background:#fff;color:#000;border:1px solid #D0D7DE;padding:6px 8px;border-radius:8px}
input[type="range"]{accent-color:#4ea1ff}
.range-hint{font-size:11px;color:var(--muted);text-align:center;margin-top:4px}
.cross{width:18px;height:18px;border:2px solid #fff;border-radius:50%;box-shadow:0 0 0 2px rgba(0,0,0,.3);position:relative;background:rgba(255,255,255,.1)}
.cross:before,.cross:after{content:"";position:absolute;background:#fff}
.cross:before{left:50%;top:2px;bottom:2px;width:2px;transform:translateX(-50%)}
.cross:after{top:50%;left:2px;right:2px;height:2px;transform:translateY(-50%)}
.fin{display:grid;place-items:center;width:28px;height:28px;border-radius:50%;background:rgba(155,108,255,.18);border:1px solid var(--violet);box-shadow:0 0 0 2px rgba(0,0,0,.25)}
.fin span{font-size:16px}
.fin-label{background:rgba(0,0,0,.45);color:#fff;padding:2px 6px;border-radius:6px;font-size:11px;margin-top:2px;white-space:nowrap; min-width: fit-content;}
.backdrop{position:fixed; inset:0; background:rgba(0,0,0,.55); display:none; align-items:center; justify-content:center; z-index:4000}
.backdrop.open{display:flex}
.modal{background:var(--panel); border:1px solid var(--border); border-radius:12px; max-width:1100px; width:min(96vw,1100px); max-height:90vh; display:flex; flex-direction:column; z-index:5000}
.modal header,.modal footer{padding:10px 14px;border-bottom:1px solid var(--border)}
.modal footer{border-top:1px solid var(--border);border-bottom:none;display:flex;gap:8px;justify-content:flex-end}
.modal .body{padding:12px;display:grid;gap:12px}
.compare{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.compare .panel{border:1px solid var(--border);border-radius:10px;overflow:hidden;position:relative;min-height:340px}
.compare .label{position:absolute;top:8px;left:8px;background:rgba(0,0,0,.4);padding:4px 8px;border-radius:6px;font-size:12px}
.kpis{display:grid;grid-template-columns:repeat(3,1fr);gap:10px}
.kpis .kpi{border:1px solid var(--border);border-radius:10px;padding:10px}
.pos{color:var(--good)} .neg{color:var(--bad)}
.popover{position:fixed;right:12px;top:58px;background:var(--panel);border:1px solid var(--border);border-radius:10px;padding:12px;max-width:420px;z-index:15;display:none}
.popover.open{display:block}
.btn:focus, .seg button:focus, input:focus, a:focus {outline:2px solid var(--focus);outline-offset:2px}
#map, .leaflet-container { z-index: 0 !important; }
body.modal-open .leaflet-container,
body.modal-open .leaflet-control-container { pointer-events:none !important; }
body.modal-open .map-wrap { filter: saturate(80%) blur(1px); }
.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}
.app-footer{background:var(--panel);border-top:1px solid var(--border);padding:12px 14px;text-align:center;font-size:13px;color:var(--muted)}
.app-footer a{color:var(--accent);text-decoration:none}
.app-footer a:hover{text-decoration:underline}
.footer-content{max-width:1200px;margin:0 auto}
